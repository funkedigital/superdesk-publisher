import React from "react";
import Item from "../../../components/ErrorLog/Item";
import { render, fireEvent } from "@testing-library/react";

const item = {
  "id": 5,
  "class": "SWP\\Bundle\\CoreBundle\\MessageHandler\\Message\\ContentPushMessage",
  "failed_at": "2020-03-02T13:07:42+00:00",
  "error_message": "Argument 1 passed to SWP\\Bundle\\CoreBundle\\MessageHandler\\AbstractContentPushHandler::__construct() must implement interface Symfony\\Component\\Messenger\\MessageBusInterface, instance of Symfony\\Bridge\\Monolog\\Logger given, called in \/private\/var\/www\/publisher\/var\/cache\/dev\/ContainerADrp4xz\/getContentPushHandlerService.php on line 17",
  "transport": "async_content_push",
  "redeliveries": [
    "2020-03-02T13:07:34+00:00",
    "2020-03-02T13:07:35+00:00",
    "2020-03-02T13:07:38+00:00",
    "2020-03-02T13:07:42+00:00"
  ],
  "message": {
    "tenant": 1,
    "content": "{\n      \"language\":\"en\",\n      \"slugline\":\"abstract-html-test\",\n      \"body_html\":\"<p>some html body edit 3 raf<\/p>\",\n      \"versioncreated\":\"2016-09-23T13:57:28+0000\",\n      \"firstcreated\":\"2016-05-25T10:23:15+0000\",\n      \"description_text\":\"some abstract text\",\n      \"place\":[\n        {\n          \"country\":\"Australia\",\n          \"world_region\":\"Oceania\",\n          \"state\":\"Australian Capital Territory\",\n          \"qcode\":\"ACT\",\n          \"name\":\"ACT\",\n          \"group\":\"Australia\"\n        }\n      ],\n      \"version\":\"2\",\n      \"byline\":\"ADmin\",\n      \"keywords\":[\n        \"keyword1\",\n        \"keyword2\"\n      ],\n      \"guid\":\"urn:newsml:localhost:2016-09-23T13:56:39.404843:56465de4-0d5c-495a-8e36-3b396def3cf0\",\n      \"priority\":6,\n      \"subject\":[\n        {\n          \"name\":\"lawyer\",\n          \"code\":\"02002001\"\n        }\n      ],\n      \"urgency\":3,\n      \"type\":\"text\",\n      \"headline\":\"testing correction\",\n      \"service\":[\n        {\n          \"name\":\"Australian General News\",\n          \"code\":\"a\"\n        }\n      ],\n      \"description_html\":\"<p><b><u>some abstract text<\/u><\/b><\/p>\",\n      \"located\":\"Warsaw\",\n      \"pubstatus\":\"usable\"\n    }"
  },
  "exception_stacktrace": "#0 \/private\/var\/www\/publisher\/var\/cache\/dev\/ContainerADrp4xz\/getContentPushHandlerService.php(17): SWP\\Bundle\\CoreBundle\\MessageHandler\\AbstractContentPushHandler->__construct(Object(Symfony\\Bridge\\Monolog\\Logger), Object(SWP\\Bundle\\CoreBundle\\Repository\\PackageRepository), Object(Symfony\\Component\\HttpKernel\\Debug\\TraceableEventDispatcher), Object(SWP\\Component\\Bridge\\Transformer\\JsonToPackageTransformer), Object(Pixers\\DoctrineProfilerBundle\\ORM\\EntityManager), Object(SWP\\Bundle\\CoreBundle\\Context\\CachedTenantContext), Object(Sentry\\State\\Hub), Object(SWP\\Bundle\\CoreBundle\\Hydrator\\PackageHydrator), Object(SWP\\Bundle\\CoreBundle\\Hydrator\\PackageHydrator))\n#1 \/private\/var\/www\/publisher\/var\/cache\/dev\/ContainerADrp4xz\/srcApp_KernelDevDebugContainer.php(1446): require('\/private\/var\/ww...')\n#2 \/private\/var\/www\/publisher\/var\/cache\/dev\/ContainerADrp4xz\/get_Messenger_HandlerDescriptor_IktyVtDService.php(11): ContainerADrp4xz\\srcApp_KernelDevDebugContainer->load('getContentPushH...')\n#3 \/private\/var\/www\/publisher\/var\/cache\/dev\/ContainerADrp4xz\/srcApp_KernelDevDebugContainer.php(1446): require('\/private\/var\/ww...')\n#4 \/private\/var\/www\/publisher\/var\/cache\/dev\/ContainerADrp4xz\/getCommand_Bus_Middleware_HandleMessageService.php(21): ContainerADrp4xz\\srcApp_KernelDevDebugContainer->load('get_Messenger_H...')\n#5 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/Handler\/HandlersLocator.php(43): ContainerADrp4xz\\srcApp_KernelDevDebugContainer->{closure}()\n#6 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/Middleware\/HandleMessageMiddleware.php(56): Symfony\\Component\\Messenger\\Handler\\HandlersLocator->getHandlers(Object(Symfony\\Component\\Messenger\\Envelope))\n#7 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/Middleware\/SendMessageMiddleware.php(79): Symfony\\Component\\Messenger\\Middleware\\HandleMessageMiddleware->handle(Object(Symfony\\Component\\Messenger\\Envelope), Object(Symfony\\Component\\Messenger\\Middleware\\TraceableStack))\n#8 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/Middleware\/ValidationMiddleware.php(48): Symfony\\Component\\Messenger\\Middleware\\SendMessageMiddleware->handle(Object(Symfony\\Component\\Messenger\\Envelope), Object(Symfony\\Component\\Messenger\\Middleware\\TraceableStack))\n#9 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/Middleware\/FailedMessageProcessingMiddleware.php(34): Symfony\\Component\\Messenger\\Middleware\\ValidationMiddleware->handle(Object(Symfony\\Component\\Messenger\\Envelope), Object(Symfony\\Component\\Messenger\\Middleware\\TraceableStack))\n#10 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/Middleware\/DispatchAfterCurrentBusMiddleware.php(67): Symfony\\Component\\Messenger\\Middleware\\FailedMessageProcessingMiddleware->handle(Object(Symfony\\Component\\Messenger\\Envelope), Object(Symfony\\Component\\Messenger\\Middleware\\TraceableStack))\n#11 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/Middleware\/RejectRedeliveredMessageMiddleware.php(42): Symfony\\Component\\Messenger\\Middleware\\DispatchAfterCurrentBusMiddleware->handle(Object(Symfony\\Component\\Messenger\\Envelope), Object(Symfony\\Component\\Messenger\\Middleware\\TraceableStack))\n#12 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/Middleware\/AddBusNameStampMiddleware.php(37): Symfony\\Component\\Messenger\\Middleware\\RejectRedeliveredMessageMiddleware->handle(Object(Symfony\\Component\\Messenger\\Envelope), Object(Symfony\\Component\\Messenger\\Middleware\\TraceableStack))\n#13 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/Middleware\/TraceableMiddleware.php(43): Symfony\\Component\\Messenger\\Middleware\\AddBusNameStampMiddleware->handle(Object(Symfony\\Component\\Messenger\\Envelope), Object(Symfony\\Component\\Messenger\\Middleware\\TraceableStack))\n#14 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/MessageBus.php(80): Symfony\\Component\\Messenger\\Middleware\\TraceableMiddleware->handle(Object(Symfony\\Component\\Messenger\\Envelope), Object(Symfony\\Component\\Messenger\\Middleware\\TraceableStack))\n#15 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/TraceableMessageBus.php(41): Symfony\\Component\\Messenger\\MessageBus->dispatch(Object(Symfony\\Component\\Messenger\\Envelope), Array)\n#16 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/RoutableMessageBus.php(54): Symfony\\Component\\Messenger\\TraceableMessageBus->dispatch(Object(Symfony\\Component\\Messenger\\Envelope), Array)\n#17 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/Worker.php(117): Symfony\\Component\\Messenger\\RoutableMessageBus->dispatch(Object(Symfony\\Component\\Messenger\\Envelope))\n#18 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/Worker.php(81): Symfony\\Component\\Messenger\\Worker->handleMessage(Object(Symfony\\Component\\Messenger\\Envelope), Object(Symfony\\Component\\Messenger\\Transport\\AmqpExt\\AmqpTransport), 'async_content_p...')\n#19 \/private\/var\/www\/publisher\/vendor\/symfony\/messenger\/Command\/ConsumeMessagesCommand.php(202): Symfony\\Component\\Messenger\\Worker->run(Array)\n#20 \/private\/var\/www\/publisher\/vendor\/symfony\/console\/Command\/Command.php(255): Symfony\\Component\\Messenger\\Command\\ConsumeMessagesCommand->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))\n#21 \/private\/var\/www\/publisher\/vendor\/symfony\/console\/Application.php(1030): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))\n#22 \/private\/var\/www\/publisher\/vendor\/symfony\/framework-bundle\/Console\/Application.php(97): Symfony\\Component\\Console\\Application->doRunCommand(Object(Symfony\\Component\\Messenger\\Command\\ConsumeMessagesCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))\n#23 \/private\/var\/www\/publisher\/vendor\/symfony\/console\/Application.php(272): Symfony\\Bundle\\FrameworkBundle\\Console\\Application->doRunCommand(Object(Symfony\\Component\\Messenger\\Command\\ConsumeMessagesCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))\n#24 \/private\/var\/www\/publisher\/vendor\/symfony\/framework-bundle\/Console\/Application.php(83): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))\n#25 \/private\/var\/www\/publisher\/vendor\/symfony\/console\/Application.php(148): Symfony\\Bundle\\FrameworkBundle\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))\n#26 \/private\/var\/www\/publisher\/bin\/console(40): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput))\n#27 {main}"
};

describe("Analytics/ArticleItem", () => {
  it("renders correctly", () => {
    const { container } = render(<Item item={item} />);

    const expandButton = container.querySelector(".cursorPointer");
    fireEvent.click(expandButton);

    expect(container.firstChild).toMatchSnapshot();
  });
});
